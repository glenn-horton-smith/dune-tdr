\section{Neutrino Interactions and Uncertainties}\label{sec:nu-osc-05} %\label{sec:physics-lbnosc-nuint}
%{\it Assigned to:} {\bf Kevin McFarland} with contributions from Kendall and the DuneReweight group. This section has a description of event generator used, justify choices of model and a description of Dune Reweight and treatment of the uncertainties.  This will be organized by reaction type or effect, preferably with overarching categories as subsections. 


%\subsection{Interaction Model Summary}
 
The goal of parameterizing the neutrino interaction model uncertainties is to provide a framework for considering how these uncertainties effect the oscillation analysis at the \dword{fd}, and for considering how constraints at the \dword{nd} can limit those uncertainties.
 
The model of neutrino interactions used for this study factorizes the neutrino
interaction on nuclei into an incoherent sum of ``hard scattering'' neutrino interactions with the single nucleons in the nucleus. The effect of the nucleus is implemented as
initial and final state interaction effects, with some (albeit few) nucleus-dependent hard scattering calculations. Schematically, we express this concept as $\text{Scattering Process} = \text{Initial State} \otimes \text{Nucleon Interaction} \otimes \text{Final State Propagation}$.  By ``initial state'' effects, we  mean a description of the momentum and position distributions of the nucleons in the nucleus, kinematic modifications to the final state (such as removal energy, sometimes described as a ``binding energy''), and Coulomb effects.   The concept of ``binding energy'' reflects the idea that the struck nucleon may be off the mass-shell inside the nucleus.  \Dword{fsi} %``Final state interactions'' (FSI) 
refer to the propagation and interaction of hadrons produced in the nucleon interaction through the nucleus. The \dword{fsi} alter both the momentum and energy of the recoiling particles produced in the final state, and may also alter their identity and multiplicity in the case of inelastic reinteractions (e.g., in a nucleus a hadron may be absorbed, rescattered, or create a secondary hadron). 
%The FSI model implemented in the GENIE, NuWro, and NEUT neutrino interaction generators is a semi-classical cascade model (or in the case of GENIE's $hA$ model a single step scaled model), based on hadron-nucleus and hadron-nucleon scattering data and theoretical corrections.  GiBUU, another available generator, uses a full particle transport model, including support for off-shell hadrons in the nuclear medium.

%Generators vary in their attempts to accurately model the largely undetected final state ``spectator'' nuclear system.  The nuclear system can carry away significant undetected momentum---hundreds of MeV is not unusual---in the form of one or more heavy, non-relativistic particles.  These particles typically carry very little kinetic energy; however they can absorb of order tens of MeV of energy from the initial state from breakup or excitation of the target nucleus.  Most of this energy and momentum will typically be invisible to the detector. 

%The factorization outlined above is not present in all parts of the model.  Most modern generators include ``2p2h'' (two particle, two hole) interactions that model meson exchange processes and scattering on highly correlated pairs of nucleons in the nucleus.  These interactions are often implemented as another process that incorporates both hard scattering and initial state effects in processes that create multiple final state nucleons, with a different prescription for different nuclei. Neutrino scattering on atomic electrons and the coherent production of pions (which scatters off the entire nucleus) also do not follow this factorization. 

The interaction model and its variations are implemented in the  \dword{genie} generator.  The fixed version of \dword{genie} used for this report, v2.12.10\footnote{At the time of the development of this report, initial pieces of \dword{genie} 3 had just recently been released (October 2018) and reweighting and documentation followed after this.  Therefore, it was not practical to use \dword{genie} 3 for this work.}
, will not contain all of the possible cross section variations which need to be modeled.  Therefore, the variations in the cross sections to be considered are implemented as some combination of: \dword{genie} weighting parameters (sometimes referred to as ``\dword{genie} knobs''), {\it ad hoc} weights of events which are designed to parameterize uncertainties or cross section corrections currently not implemented within \dword{genie}, and as discrete alternative model comparisons, achieved through alternate generators, alternate \dword{genie} configurations, or custom weightings. 

%Discrete alternative model comparisons are valuable, but are used sparingly in this work due to finite computational resources and ease of interpretation. The approach taken was to identify classes of uncertainties and provide generous uncertainties intended to span a reasonable range of alternate models. Using the alternate model as mock data either provides a closure test, or a mechanism by which to inflate uncertainties. Most of the alternate models in alternate generators (GiBUU, NEUT and NuWro) or alternate configurations of GENIE are expected to be covered by the uncertainties described here. 

%It is not guaranteed that the alternate models will be covered by the chosen systematic uncertainty, but analysis  of alternate models can be computationally slow and interpretation not easy; there may be artificial reasons (e.g. a given generator's implementation choice ) which can create unexpected effects. 

%For this work, we chose one particular discrete alternate model as a source of uncertainty, inspired by differences in models but which has a well defined implementation and interpretation; it is described in Section~\ref{sec:fsi}. The most problematic feature of an interaction model for any oscillation analysis is if the model uncertainties are incomplete in the association between reconstructed observables and true neutrino energy. A special mock data sample was created which preserved the same observables for on-axis samples as the default sample, but which significantly modifies the observable--true energy relationship.
%This isolates one of the fundamental issues, which is that all tests of the relationship to true neutrino energy via observables have so far been largely indirect and averaged over a broad 

%\fixme{ KM outline:}
%- Future work on DUNE will develop better machinery for alternate generators; this is a computational and technical challenge faced by many experiments; 
%-- LBNC may not accept "computing limitations" so trying to finesse this
%- Alternate generators provide a closure test of the weighting scheme and/or a new uncertainty
%-- NEUT/NuWro variations expected to be covered by current parameterization, but generally, 
%-- the uncertainties generally span the availible GENIE alternate configurations. (non-reweightable knobs that are  implemented, e.g., formation zone and other hadronization uncertainties-- not quite)
%--But, there can be artificial reasons why a particular generator-generator comparison may not reflect error (e.g. bug in implmentatin). We can't generally know how to interpret the results, so they are not considered here.

%- One single important case-- and this is the most worrysome case which the alternate generators embody:  This mock data sets modify the reconstructed to true neutrino energy relationship, while preserving the outgoing final state particle kinematics. This isolates one of the fundamental issues, which is that all tests of the relationship to true neutrino energy via observables have so far been largely indirect and averaged over a broad flux.
\subsection{Interaction Model Uncertainties}

The interaction uncertainties are divided into seven roughly exclusive groups: (1) initial state uncertainties, (2) hard scattering uncertainties and nuclear modifications to the quasielastic process, (3) uncertainties in multinucleon (2p2h) hard scattering processes, (4) hard scattering uncertainties in pion production processes, (5) uncertainties governing other, higher $W$ and neutral current processes, (6) \dword{fsi} uncertainties, (7) neutrino flavor-dependent uncertainties. Uncertainties are intended to reflect current theoretical freedom, deficiencies in implementation, and/or current experimental knowledge.  In many cases of nuclear effects, there are relatively stringent constraints on processes because of measurements on lighter targets, but additional sources of uncertainty on argon. 

%We also discuss cases where the parameterization is limited or simplified.

Initial state uncertainties, for example the average energy required to separate a nucleon from the nucleus, are evaluated within a modified global Fermi gas model.  Alternate initial state models exist. Spectral functions~\cite{Benhar:1994hw,Nieves:2004wx}, the mean field model of \dword{gibuu}~\cite{Gallmeister:2016dnq}, or \dword{crpa} calculations~\cite{Pandey:2014tza} all appear to  provide better descriptions of the nuclear initial state~\cite{Sobczyk:2017mts}.   It is generally impossible to weight predictions from one initial state model to another to compare predictions, because they occupy different phase space, and such studies would have to be done with alternate \dword{mc} simulations. Here, we attempt, where possible, to approximate relevant alternate models of effect with weights, with that as a limitation.

Hard scattering uncertainties in quasielastic scattering,  pion production, and higher $W$ processes are implemented in \dword{genie}.  In some cases, we augment the uncertainties included in \dword{genie} to reflect observed discrepancies in neutrino scattering.

One part of the Nieves et al.\cite{nieves1,nieves2} description of the $0\pi$ interaction on nuclei includes a screening effect referred to by the calculational technique, RPA, used to sum the $W^\pm$ self-energy terms. 
%In practice, this modifies the 1p1h/Quasi-Elastic cross-section in a non-trivial way. 
The calculations from Nieves et al. have associated uncertainties presented in \cite{nieves_uncert}, which have been evaluated as a function of $Q^2$~\cite{sanchez-private}.”.
 In 2018, \dword{minerva} and \dword{nova} parameterized the central value and uncertainty in $(q_0, q_3)$ following the prescription of Ref.~\cite{RikRPA}, whereas \dword{t2k} used central values and uncertainties in $Q^2$ only. Here we use \dword{t2k}'s 2017/8 parameterization of the \dword{rpa} effect\cite{t2k_2018} due to its simplicity.

We start with the Nieves et al.\ or ``Valencia'' model~\cite{nieves1,nieves2} for multinucleon ($2p2h$) contributions to to the cross section.  However, \dword{minerva} has shown directly~\cite{Rodrigues:2015hik}, and \dword{nova} indirectly, that this description is missing observed strength on carbon. The extra strength from the ``\dword{minerva} tune'' to $2p2h$ is applied in $(q_0,q_3)$ space (where $q_0$ is energy transfer from the leptonic system, and $q_3$ is the magnitude of the three momentum transfer). Reasonable fits to \dword{minerva}'s data are found by attributing the missing strength to any of $2p2h$ from $np$ initial state pairs, $2p2h$ from $nn$ initial state pairs, or $1p1h$ or quasielastic processes.  

The rates for $1p1h$ and $2p2h$ processes could be different on argon and carbon targets.  There is little neutrino scattering data to inform this, but there are measurements of short-ranged correlated pairs from electron scattering on different nuclei~\cite{Colle:2015ena}.   We add additional uncertainties to account for this possibility, constrained by electron scattering measurements.  Similarly, the discrepancies observed by \dword{nova} and \dword{minerva} may be neutrino energy dependent, and additional uncertainties are added to account for this.

\Dword{fsi} have been extensively tested on carbon targets, but not yet on argon targets.  We have included an ad hoc uncertainty, based on a fraction of the entire size of the final state interaction effect on reconstructable energy in carbon targets as a modification to the effect of final state interactions on argon.

Finally, there are uncertainties related to how interactions differ in neutrino flavor.  One source of these is in form factors which may be uncertain in the nuclear environment, and another is the effect of electroweak radiative corrections~\cite{Day-McFarland:2012}.  We also consider the possibility that neutrino interactions which occur in energy and momentum transfer space, $(q_0,q_3)$, in which there are no muon neutrino interactions for kinematic reasons, may contain surprises in the electron neutrino cross-section in that space.  In particular, nuclear screening and multinucleon processes have a significant effect in these regions.  We allow a large variation of the cross section in these narrow kinematic regions.

Details of the interaction model are given in Appendix~\ref{sec:physics-lbnosc-nuint-app}


%%%% end abbreviated intro



  
% The model of neutrino interactions used for this study factorizes the neutrino
% interaction on nuclei into an incoherent sum of ``hard scattering'' neutrino interactions with the single nucleons in the nucleus. The effect of the nucleus is implemented as
% initial and final state interaction effects, with some (albeit few) nucleus-dependent hard scattering calculations. Schematically, we express this concept as $\text{Scattering Process} = \text{Initial State} \otimes \text{Nucleon Interaction} \otimes \text{Final State Propagation}$.


% By ``initial state'' effects, we  mean a description of the momentum and position distributions of the nucleons in the nucleus, kinematic modifications to the final state (such as removal energy, sometimes described as a ``binding energy''), and Coulomb effects.   The concept of ``binding energy'' indicates that the struck nucleon may be off the mass-shell inside the nucleus.  
% ``Final state interactions'' (FSI) refer to the propagation and interaction of hadrons produced in the nucleon interaction through the nucleus. The FSI alter both the momentum and energy of the recoiling particles produced in the final state, and may also alter their identity and multiplicity in the case of inelastic reinteractions (e.g., in a nucleus a hadron may be absorbed, rescattered, or create a secondary hadron).  The FSI model implemented in the GENIE, NuWro, and NEUT neutrino interaction generators is a semi-classical cascade model (or in the case of GENIE's $hA$ model a single step scaled model), based on hadron-nucleus and hadron-nucleon scattering data and theoretical corrections.  GiBUU, another available generator, uses a full particle transport model, including support for off-shell hadrons in the nuclear medium.

% Generators vary in their attempts to accurately model the largely undetected final state ``spectator'' nuclear system.  The nuclear system can carry away significant undetected momentum---hundreds of MeV is not unusual---in the form of one or more heavy, non-relativistic particles.  These particles typically carry very little kinetic energy; however they can absorb of order tens of MeV of energy from the initial state from breakup or excitation of the target nucleus.  Most of this energy and momentum will typically be invisible to the detector. 

% The factorization outlined above is not present in all parts of the model.  Most modern generators include ``2p2h'' (two particle, two hole) interactions that model meson exchange processes and scattering on highly correlated pairs of nucleons in the nucleus.  These interactions are often implemented as another process that incorporates both hard scattering and initial state effects in processes that create multiple final state nucleons, with a different prescription for different nuclei.
% Neutrino scattering on atomic electrons and the coherent production of pions (which scatters off the entire nucleus) also
% do not follow this factorization. 

% The interaction model and its variations are implemented in the  GENIE generator.  The fixed version of GENIE used for this report, v2.12.10\footnote{At the time of the development of this report, GENIE 3 had just recently been released (October 15, 2018).  However, at the time of that release, there was no documentation of the tunes, and the code required to implement uncertainties had also not been released; therefore, it was not feasible to use GENIE 3 for this work.}, will not contain all of the possible cross section variations which need to be modeled.  Therefore, the variations in the cross sections to be considered are implemented as some combination of: GENIE weighting parameters (sometimes referred to as ``GENIE knobs''), {\it ad hoc} weights of events which are designed to parameterize uncertainties or cross section corrections currently not implemented within GENIE, and as discrete alternative model comparisons, achieved through alternate generators, alternate GENIE configurations, or custom weightings. 

% %Discrete alternative model comparisons are valuable, but are used sparingly in this work due to finite computational resources and ease of interpretation. The approach taken was to identify classes of uncertainties and provide generous uncertainties intended to span a reasonable range of alternate models. Using the alternate model as mock data either provides a closure test, or a mechanism by which to inflate uncertainties. Most of the alternate models in alternate generators (GiBUU, NEUT and NuWro) or alternate configurations of GENIE are expected to be covered by the uncertainties described here. 

% %It is not guaranteed that the alternate models will be covered by the chosen systematic uncertainty, but analysis  of alternate models can be computationally slow and interpretation not easy; there may be artificial reasons (e.g. a given generator's implementation choice ) which can create unexpected effects. 

% %For this work, we chose one particular discrete alternate model as a source of uncertainty, inspired by differences in models but which has a well defined implementation and interpretation; it is described in Section~\ref{sec:fsi}. The most problematic feature of an interaction model for any oscillation analysis is if the model uncertainties are incomplete in the association between reconstructed observables and true neutrino energy. A special mock data sample was created which preserved the same observables for on-axis samples as the default sample, but which significantly modifies the observable--true energy relationship.
% %This isolates one of the fundamental issues, which is that all tests of the relationship to true neutrino energy via observables have so far been largely indirect and averaged over a broad 

% %\fixme{ KM outline:}
% %- Future work on DUNE will develop better machinery for alternate generators; this is a computational and technical challenge faced by many experiments; 
% %-- LBNC may not accept "computing limitations" so trying to finesse this
% %- Alternate generators provide a closure test of the weighting scheme and/or a new uncertainty
% %-- NEUT/NuWro variations expected to be covered by current parameterization, but generally, 
% %-- the uncertainties generally span the availible GENIE alternate configurations. (non-reweightable knobs that are  implemented, e.g., formation zone and other hadronization uncertainties-- not quite)
% %--But, there can be artificial reasons why a particular generator-generator comparison may not reflect error (e.g. bug in implmentatin). We can't generally know how to interpret the results, so they are not considered here.

% %- One single important case-- and this is the most worrysome case which the alternate generators embody:  This mock data sets modify the reconstructed to true neutrino energy relationship, while preserving the outgoing final state particle kinematics. This isolates one of the fundamental issues, which is that all tests of the relationship to true neutrino energy via observables have so far been largely indirect and averaged over a broad flux.
% \subsection{Interaction Model Uncertainties}

% The interaction uncertainties are divided into seven roughly exclusive groups: (1) initial state uncertainties, (2) hard scattering uncertainties and nuclear modifications to the quasielastic process, (3) uncertainties in multinucleon (2p2h) hard scattering processes, (4) hard scattering uncertainties in pion production processes, (5) uncertainties governing other, higher $W$ and neutral current processes, (6) final state interaction uncertainties, and (7) neutrino flavor dependent uncertainties. Uncertainties are intended to reflect current theoretical freedom, deficiencies in implementation, and/or current experimental knowledge.  In many cases of nuclear effects, there are relatively stringent constraints on processes because of measurements on lighter targets, but additional sources of uncertainty on argon. 

% %We also discuss cases where the parameterization is limited or simplified.

% Initial state uncertainties, for example, the average energy required to separate a nucleon from the nucleus, are evaluated within a modified global Fermi gas model.  Alternate initial state models exist. Spectral functions~\cite{Benhar:1994hw,Nieves:2004wx}, the mean field model of GiBUU~\cite{Gallmeister:2016dnq}, or CRPA calculations~\cite{Pandey:2014tza} all appear to  provide better descriptions of the nuclear initial state~\cite{Sobczyk:2017mts}, but it is generally \impossible to weight predictions from one initial state model to another to compare predictions, and such studies would have to be done with alternate Monte Carlo simulations.

% Hard scattering uncertainties in quasielastic scattering,  pion production, and higher $W$ processes are implemented in GENIE.  In many cases, we augment the uncertainties included in GENIE to reflect observed discrepancies in neutrino scattering.

% One part of the Nieves et al.\cite{nieves1,nieves2} description of the $0\pi$ interaction on nuclei includes RPA, used to sum the $W^\pm$ self-energy terms. In practice, this modifies the 1p1h/Quasi-Elastic cross-section in a non-trivial way. The calculations from Nieves et al. have associated uncertainties presented in \cite{nieves_uncert}, which were evaluated as a function of $Q^2$ by Federico Sanchez. In 2018, MINERvA and NOvA parameterized the central value and uncertainty in $(q_0, q_3)$ using Rik Gran's RPA uncertainties\cite{RikRPA}, whereas T2K used central values and uncertainties in $Q^2$ only. Here we use T2K's 2017/8 parameterization of the RPA effect\cite{t2k_2018} due to its simplicity.

% We start with the Nieves et al.\ or ``Valencia'' model~\cite{nieves1,nieves2} for multinucleon ($2p2h$) contributions to to the cross section.  However, MINERvA has shown directly~\cite{Rodrigues:2015hik}, and NOvA indirectly, that this description is missing observed strength on carbon. The extra strength from the ``MINERvA tune'' to $2p2h$ is applied in $(q_0,q_3)$ space (where $q_0$ is energy transfer from the leptonic system, and $q_3$ is the magnitude of the three momentum transfer). Reasonable fits to MINERvA's data are found by attributing the missing strength to any of $2p2h$ from $np$ initial state pairs, $2p2h$ from $nn$ initial state pairs, or $1p1h$ or quasielastic processes.  

% The rates for $1p1h$ and $2p2h$ processes could be different on argon and carbon targets.  There is little neutrino scattering data to inform this, but there are measurements of short-ranged correlated pairs from electron scattering on different nuclei~\cite{Colle:2015ena}.   We add additional uncertainties to account for this possibility, constrained by electron scattering measurements.  Similarly, the discrepancies observed by NOvA and MINERvA may be neutrino energy dependent, and additional uncertainties are added to account for this.

% \fixme{Text below not complete}
% Final state interactions have been extensively tested on carbon targets, NOT DONE.

% DIDN'T YET WRITE ELECTRON MUON DIFFERENCE.

% Details of the interaction model are given in Appendix~\ref{sec:physics-lbnosc-nuint-app}
