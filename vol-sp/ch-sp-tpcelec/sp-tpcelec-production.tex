\section{Production and Assembly}
\label{sec:fdsp-tpcelec-production}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Spares Plan}
\label{sec:fdsp-tpcelec-production-spares}

The \dword{apa} consortium plans on building 152 \dword{apa}s
for the first Single--Phase detector. This means that at least
3,040 \dwords{femb} with the corresponding bundles of cold
cables (3,040 power and 3,040 data cables, plus 1,216 bias voltage
cables; half of the cables will have the length required for 
integration on the top \dword{apa}s, while the other half will
be compatible with the bottom \dword{apa}s) will be required for 
the integration. The \dword{ce} consortium is planning on
building at least 5\% of spare \dwords{femb} (i.e. build 3,200
\dwords{femb}). If the need for further spares arises during the
\dword{qc} process or during the Integration, additional 
\dwords{femb} can be produced quickly provided that there is
a sufficient quantity of components that have long lead times.
For components with long lead times we plan to have on hand a
larger number of spares. The \dwords{asic} are clearly one item
that can have a long lead time and the spares plan for those is
discussed below. For others discrete components
(capacitors, resistors, connectors, voltage regulators, crystals)
plans will be put in place once the final design of the \dword{femb}
is available and vendors are contacted. It should be noted that the
size of the \dword{femb} production is such that the total number
of some components exceeds the usual stock of some of the distributors.

For the \dwords{asic}, the number of
spare chips is actually driven by the fact that the fabrication
takes place in batches of 25 wafers. The exact number of \dwords{asic} 
on a production wafer is known only after the final reticle layout
is done by the foundry that fabricates the chips. For the moment
an estimate can be obtained using the size of the different 
chips and assuming that only reticles that are fully contained
within the wafer nominal value are usable. This is generally
an underestimate of the number of chips that can be obtained 
from a wafer. Based on these estimates the expected number
of chips per wafer is 390 for \dword{larasic}, 928 and 232 for the \dword{coldadc}
and \dword{coldata}, respectively, which will be fabricated together on the same wafer,
and 220 in the case of \dword{cryo}. The differences between these
numbers are due to the different sizes of the chips and the
different size of the silicon wafers used in the various 
technologies. To estimate the number of chips that can be
used for installation on the \dwords{femb} the assumption is
made that 10\% of the chips will fail during the \dword{qc}
process described later in this Section, and an additional
5\% of the chips fail during dicing and packaging. This means
that for the 3,200 \dwords{femb} approximately 30,000 \dword{larasic} and
\dword{coldadc}, plus 7,500 \dword{coldata} chips would be required, or 7,500
\dword{cryo} chips. This corresponds to at least 77 \dword{larasic} wafers,
33 \dword{coldadc} plus \dword{coldata} wafers, and 35 \dword{cryo} wafers for one
Single Phase detector. The requirement that wafers be ordered
in batches of 25 clearly results in a significant number of
spares. The number of spare chips available can be somehow
reduced if the purchase of wafers is made for two Single
Phase detectors. 

In general for other components we plan to procure between 5 and
10\% of spares during the construction of the first Single Phase
detector. We will use the higher number for components that have
a larger risk of being damaged during the integration and 
installation. One example is that of the cold cables, where we
plan for 10\% of spares for the cables for the bottom \dword{apa}
that have to be routed through the \dword{apa}s' frames, while
the plan for the top \dword{apa} foresees only 5\% of spares.
The number of spares will be reduced for a second Single Phase
detector, under the assumption that unused spares from the first
detector will be available.

The components on the top of the cryostat (power supplies, bias
voltage supplies, cables, \dwords{wiec} with their \dword{wib}
and \dword{ptc} boards) can be replaced during operations of the
detector. For these components additional spares may be required
during the \dunelifetime operation period of the DUNE detector.
The initial plan is to purchase 10\% of spares for the first
Single  Phase detector, and use them also for a second detector
(i.e. having effectively 5\% of spares). Once the design of
the \dwords{wib} is finalized a decision should be made on whether
extra spares should be purchased for \dwords{fpga} and optical
transmitters and receivers. These are commercial components 
that may no longer be available after a certain number of 
years of operations, which could prevent the \dword{ce} consortium from
fabricating additional spare \dwords{wib} if required. This
is a risk that is discussed in Section~\ref{sec:fdsp-tpcelec-risks-commissioning}.
It could be alleviated by placing the commercial components
on mezzanine cards to minimize the amount of redesign of
boards that would be required if these components are no longer available.
It can also be alleviated by stocking additional components
once there are evident market trends showing that they are 
becoming harder or impossible to procure.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Procurement of Parts}
\label{sec:fdsp-tpcelec-production-procurement}

The construction of the detector components for DUNE that are a
responsibility of the \dword{ce} consortium requires many
large procurements that need to be carefully planned to avoid
incurring delays. For the \dwords{asic} the choice of the vendor(s)
has already been made at the time of the choice of the technology
used for the design of the chips. For almost all other components
the expectation is that multiple vendors could bid on the same 
package, which depending on the requirements of the funding
agency and of the responsible institution may require a lengthy
selection process. In most cases it should be feasible to choose
the best bidder among multiple reliable vendors. One critical case
is that of the cold cables used to transmit the data from the
\dwords{femb} to the \dwords{wib}, where a technical qualification
including tests with the entire cold chain (from the \dword{femb}
to the receiver on the \dword{wib}) may be necessary. One of the
problems that needs to be faced is the large amount of components
that is required. In some cases the number of components of a given
type (resistors, capacitors) may exceed by far the number of components
of that kind that the usual resellers keep in stock. This will 
require careful planning to avoid having the assembly chain for
the \dwords{femb}, for example, stopped because of the lack of
one kind of component.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Assembly}
\label{sec:fdsp-tpcelec-production-assembly}

The plan of the \dword{ce} consortium is to minimize
the amount of assembly work performed at any of the participating
institutions. When assembly work is required, it will be performed
by external companies: examples are the installation of surface 
mount components, \dwords{asic}, \dwords{fpga} on the printed 
circuit boards for the \dwords{femb} and the \dwords {wib}, or
the assembly of the crossing tube cable supports. One of the few
exceptions is the assembly of the \dwords{wiec}, that involves
mechanical and electrical connections of the backplane and of
the supports of the crates. Another component that possibly 
will be assembled at one of the consortium's institutions is
the plug attached to the cold cables, which is used to protect 
the \dwords{femb} from \dword{esd} damage. During the engineering
phase and for components that are fabricated in small samples, 
like boards used for testing other components, the plan is to
perform the assembly steps in one of the consortium's institutions.
Further assembly of components and integration with parts
provided by other consortia takes place at the \dword{itf} and
at \surf. This is discussed in Section~\ref{sec:fdsp-tpcelec-integration}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Quality Control}
\label{sec:fdsp-tpcelec-production-qc}

Once the \dword{apa}s are installed inside the cryostat, there will
be limited access to the detector components provided by the \dword{ce}
consortium. After the closure of the \dword{tco} there will not
be any access to detector components that are supposed to
last for the entire lifetime of the experiment (\dunelifetime). This
puts very stringent requirements on the reliability of these
components, which has been already addressed in part through 
the \dword{qa} program discussed in Section~\ref{sec:fdsp-tpcelec-qa}. The
next step is a careful application of stringent \dword{qc} procedures on the 
detector parts that are going to be installed in the detector.
All the detector components installed inside the cryostat will
be tested and sorted before they are prepared for integration
with other detector components and for installation. The full
details of the \dword{qc} plan have not been put in place
yet, and the specific selection criteria for the components will
be defined only after the completion of the current design and
prototyping phase. For each detector component a preliminary
version of the \dword{qc} program will be developed prior
to the Engineering Design Review. The program will then be used for
the qualification of the components fabricated during the 
pre-production. It will be modified, if necessary, prior to the Production
Readiness Review that triggers the start of the production of the
detector components used for the detector assembly.

Some of the requirements for the \dword{qc} plans can
be laid out already at this time, based on the lessons learned
from the construction and commissioning of the \dword{pdsp}
detector. Experience with \dword{pdsp} shows that a small fraction
($\approx4$\%) of the \dword{fe} \dwords{asic} that passes the
qualification criteria at room temperature, fails the tests
when immersed in \lntwo. Therefore plans are being put
in place for testing all the \dwords{asic} in \lntwo
before they are mounted on the \dwords{femb}, in addition to the
cryogenic testing of the \dwords{femb}. The goal of testing 
the \dwords{asic} in \lntwo is to minimize the need
for reworking the \dwords{femb}. This is more important in the
case where the three \dword{asic} solution is chosen for the
\dword{femb}. Given that in this case there are 18 \dwords{asic} on the
\dword{femb} a requirement that only 2\% of the \dwords{femb}
require rework would put a stringent requirement that less than
0.11\% of the \dwords{asic} fail during immersion in \lntwo.
If the \dword{cryo} solution is chosen for the \dwords{asic}
to be used on the \dwords{femb}, the 2\% requirement for the
number of \dwords{femb} to be reworked translates in a 
maximum failure rate of 1\%, given that there are only two
\dwords{asic} on the \dwords{femb}. Based on the \dwords{pdsp}
experience discrete components like resistors and capacitors
do not need to undergo cryogenic testing prior to their installation
on the \dwords{femb}. It is common for capacitors and resistors
to be sold in reels containing a few thousand components, which
in some cases is a sufficient quantity to fabricate ten
\dwords{femb}. For these components we are planning to
perform cryogenic tests on samples of a few components
from each reel, prior to using the reel in the assembly of
\dwords{femb}. There will be other components installed on
the \dwords{femb} like voltage regulators and crystals that
most probably will have to be qualified like the \dwords{asic}
in \lntwo prior to being mounted on the \dwords{femb}.

For the large quantities of
\dwords{asic} required for one DUNE \dword{sp} detector
(6,000 or 54,000 chips depending on the \dword{asic} solution
chosen) manual testing of the chips requires excessive 
resources and, based on the lessons learned from the 
construction of \dword{pdsp}, would lead to rejection
factors that are not acceptable. Ideally the entire testing
process would be performed with a robotic system, where 
a robotic arm picks the \dword{asic} from a tray, places
it on a test board and holds it in place while the test
is being performed, and then sorts it into a second tray
depending on the test result. The requirement that the test
is performed in \lntwo prevents us from using this
scheme. One of the biggest problems observed during the
\dword{pdsp} construction is the placement of the chips in
the sockets, in addition to the issues with condensation
that have been addressed with the development of the \dword{cts}.
To overcome the issues with the manual placement of the chips in
the sockets we are planning to develop a robotic system
to perform this operation. Once the \dwords{asic} are 
placed on test boards, these will be moved manually into 
upgraded versions of the current \dword{cts} that can
house multiple test boards. At the end of the testing
procedure the robotic system will then be used to remove
the chips from the test boards and sort them according to
the test results. Based on the experience with the tests of
the \dword{pdsp} \dwords{asic} and also from other experiments
plans are also being made for cleaning the sockets on the 
test boards and for replacing them after a certain number of
testing cycles. To test all the \dwords{asic} required for
the construction of one single--phase detector we plan to
have between two and six test sites, each equipped with a
robotic system and an upgraded \dword{cts}. All the tests
will be performed following a common set of instructions
at all sites. To ensure that all sites produce similar
results we will have a reference set of \dwords{asic}
that will be initially used to cross-calibrate the 
test procedures among sites and then to check the 
stability of the test equipment at each site. Test results will
be stored in a database and criteria will be developed
for the acceptance of \dwords{asic}. The acceptance rate 
will be monitored and in case of problems
the failures will be analyzed and root cause analyses
will be performed to address the issues. If necessary,
the test program will be stopped at all sites while 
issues are being investigated.

Prior to assembly, the printed circuit boards for the
\dwords{femb} will be tested by the vendor for electrical
continuity and shorts. The usual approach for particle physics
experiments is to perform a visual inspection of the boards
prior to the installation of the discrete components and of
the \dwords{asic}, and to repeat this inspection after the
installation and prior to the functionality test, that in
case of DUNE will be performed in \lntwo. The
specifications on vias and pads for the printed circuit
boards for the \dwords{femb} are not at the edge of the
industrial vendors' capabilities and therefore we do not
expect these inspections to be absolutely necessary. We will
perform visual inspections on a sample of the 
production, but we will also investigate the possibility
of using other, possibly automatic, inspection methods for
the bulk of the production. After assembly, 
each \dword{femb} will be tested in \lntwo using
the current \dword{cts} (a total of nine have already been
fabricated and are being distributed among the institutions
in the consortium). The test procedures are likely to be
very similar to the ones adopted for \dword{pdsp}, the main
difference being that the tests will not be performed with
the final cables to be used in the experiment, but rather
with a temporary set of cables. This requires that the 
cables be tested separately. The tests of the \dwords{femb}
are performed using the \dword{cts} which allows a turnaround
time for testing of about one hour per \dword{femb}. In the
test the \dword{femb} is connected to a capacitive load that
simulates the presence of the \dword{apa}'s wires. This allows
connectivity checks for each channel and measurements of
the baseline and of the RMS of the noise. Calibration 
pulses will be injected in the front-end amplifier, digitized
and readout. These injected pulses will also be used
to determine the calibration constants of the \dword{adc}. 
The test set-up requires one \dword{wib} and
a printed-circuit board similar to that used on the cryostat
penetration, allowing for the simultaneous test of four \dwords{femb}.
A standalone 12V power supply is required and the readout
of the \dword{wib} uses a direct Gb Ethernet connection to
a PC. The set-up used for \dword{asic} testing is similar.
In both cases the data can be processed locally on the PC
and the results from the tests and calibrations are then stored 
in a database. The plan is to have the capability to retrieve  
these test and calibration results throughout the entire life
of the experiment. As in the case of \dwords{asic}' testing
we will be monitoring the test results to ensure that all
sites have similar test capabilities and yields and to
identify possible problems during the production.
Further tests will be performed on the \dwords{femb}
prior to and after their installation on the \dword{apa}s, as
discussed in Section~\ref{sec:fdsp-tpcelec-integration-timeline}.

The final component provided by the \dword{ce} consortium
that is installed inside the cryostat is the ensemble of cold
cables: the cables carrying the bias voltage for the \dword{apa}
wires, the electron diverters and the field cage termination electrodes,
the cables carrying the low voltage power to the \dwords{femb},
and the data cables that carry the clock and control signals
to the \dwords{femb} and are also used for the readout. It is not
feasible nor necessary to test these cables in \lntwo,
as they will usually perform better at cold compared with
room temperature. We will perform checks on all the cables 
during the production, prior to their installation and 
connection to the \dwords{femb}. A further test will take place
when the \dword{apa}s are tested in the cold boxes at the \dword{itf}
and at \surf. The checks performed at room temperature include
the measurement of the resistance of all the cables, checking for
shorts, and in the case of the data cables a measurement of the
eye diagram when transmitting data at the same data as from the
\dword{femb}. Visual inspections will be performed on the connectors
to ensure that they do not show any sign of damage.

Stringent requirements need to be applied also on the cryostat
penetrations, to avoid Argon leaks. The cryostat penetrations are
made of two parts: the first is the crossing tube with its spool pieces,
and the second one is made of the three flanges that are used for
connecting the power, control, and readout electronics with the
\dword{ce} and the \dword{pds} components inside the
cryostat. On each cryostat penetration there are two flanges for
the \dword{ce} and one for the \dword{pds}. The crossing
tubes with their spool pieces are fabricated in industry and tested
by the vendors to be leak and pressure proof. The flanges are assembled
in institutions of the \dword{ce} and \dword{pds} consortia,
and need to undergo both electrical and mechanical tests to ensure their
functionality. Electrical tests consist in checking that all the
signals and voltages are passed properly between the two sides of the
flange and that there are no shorts. Mechanical tests consist in 
checking that the flange itself is leak and pressure proof. Further
leak tests are performed after the cryostat penetrations are installed
on the cryostat and later after the \dword{ce} and \dword{pds}
cables are attached to the flanges. These leak tests are
performed by releasing Helium gas in the cryostat penetration and
checking for the presence of Helium on the top of the cryostat. Similar
tests have also been performed during the \dword{pdsp} installation.

All the other detector components that are a responsibility of
the \dword{ce} consortium can be replaced, if necessary,
even during operation of the detector. Still, every component
will be tested prior to the installation in \surf, to ensure a
smooth commissioning of the detector. The \dwords{wiec} will be
assembled and tested with all the \dwords{wib} and \dword{ptc}
installed. Testing requires a slice of the \dword{daq} back-end,
power supplies and at least one \dword{femb} to check all the
connections. All the cables between the bias voltage supplies and
the end flange and all the cables between the low voltage power
supplies and the \dwords{ptc} will be tested for electrical
continuity and for shorts. All power supplies will undergo a
period of burn-in with appropriate loads before being installed
in the cavern. Optical fibers will be tested by measuring the
eye diagram for data transmission at the required speed. All
test equipment used for qualifying the components to be installed
in the detector will be either transported to \surf or duplicated
at \surf, to be used as diagnostic tool during operations.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Test Facilities}
\label{sec:fdsp-tpcelec-production-facilities}

The \dword{qc} plan described in the previous Section requires
multiple test stands that need to be put in place and exercised 
before the beginning of the production activities. For the \dwords{asic}'
testing a setup similar to that of the \dword{cts} discussed in
Section~\ref{sec:fdsp-tpcelec-qa-facilities-additional} will
be used. In this setup multiple test boards housing up to 24
chips will be immersed in \lntwo prior to running the
electronics tests and later warmed up to room temperature in 
a Nitrogen atmosphere to avoid condensation on the chips and
boards. As mentioned above, the placing of the chips on the test 
boards will be performed with a robotic system. The test setups,
one for each kind of \dword{asic}, will be an evolution of those
used initially for characterizing the \dword{asic} and similar
to the setups used for qualifying the chips used in the \dword{pdsp}
construction. The tests of the \dwords{femb} will be performed with
setups that include the use of \dwords{cts} for the cryogenic part
and that are otherwise simple evolutions (with newer \dwords{wib})
of the setups used for the characterization of the \dwords{femb}
for \dword{pdsp}. Cold and warm power and bias voltage cables will
be characterized with test stations that require the relevant 
power supplies plus some cable testing equipment, that most likely will
use (at least for the power cables) commercial off the shelf components.
For the test of the data cables we will probably rely on a setup
using waveform generators plus an high end oscilloscope that 
can handle 2.56 Gbps signals and measure eye-diagrams. 
Burn-in stations, with custom designed loads, may be required for 
the commercial low voltage power and bias voltage supplies.
A test setup to check \dwords{wiec} with their \dwords{wib}
and \dwords{ptc} will require a minimal DAQ back-end that the
DAQ consortium should provide.

Given the delay between the beginning of the production of the
\dword{apa}s and of the components that are a responsibility of
the Cold  Electronics consortium, and the availability of the
integration setup at \surf in front of the cryostat, it is
desirable to  perform the integration of the \dwords{femb}
on a fraction of the \dword{apa}s and perform tests in cold
boxes. During the pre-production phase this can be done at CERN,
but later it is desirable to perform the integration and the
tests at the \dword{itf}, which then would require a cold box,
as well as a full power, control, and readout system, similar
to the one described later in Section~\ref{sec:fdsp-tpcelec-integration-qc}.
